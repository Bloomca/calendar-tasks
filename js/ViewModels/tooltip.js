define(["knockout","Tasks"],function(t,e){function a(){this.active=t.observable(null),this.tasks=t.observableArray(),this.showTooltip=t.observable(!1),this.note=t.observable(""),this.addNote=function(){var t=this.note();this.note(""),r.blur();var a=t.split("/n")[0];a.length>16&&(a=a.slice(0,15)+"...");var s={title:a,body:t};this.tasks.push(s),this.active().tasks.push(s),e[this.active().dateString]=this.active().tasks(),i()};var a=this;this.deleteNote=function(t){a.active().tasks.remove(t),a.tasks.remove(t),e[a.active().dateString]=a.active().tasks(),i()},this.toggleNote=function(t,e){if("H3"===e.target.tagName){var a=e.target.classList;a.contains("active")?a.remove("active"):a.add("active")}}}function i(){localStorage&&localStorage.setItem("calendar-tasks",JSON.stringify(e))}function s(t){return!t.offsetWidth&&!t.offsetHeight}var o=document.getElementById("app"),n=document.getElementById("tooltip"),r=n.querySelector("textarea"),c=new a;return t.applyBindings(c,n),document.addEventListener("click",function(t){if(!s(n)){for(var e=t.target;e;){if(e===o)return;e=e.parentNode}c.showTooltip(!1)}}),c});