define(["knockout","ViewModels/dayTasks","Tasks"],function(e,t,a){function n(e){var t=[],a=new Date(+e),n=a.getDay(),d=e.getMonth(),r=e.getFullYear()+"-"+d+"-";if(n){a.setDate(-(n-1));for(var l=a.getDate(),i=0;n>i;i++)t.push({num:l,date:a.getFullYear()+"-"+a.getMonth()+"-"+l++,anotherMonth:!0})}var o=new Date(e.getFullYear(),e.getMonth()+1,0);for(i=0;i<o.getDate();i++)t.push({num:i+1,date:r+(i+1)});var s=t.length%7,u=new Date(e.getFullYear(),e.getMonth()+1,1);for(i=0;s>i;i++)t.push({num:i+1,date:u.getFullYear()+"-"+u.getMonth()+"-"+(i+1),anotherMonth:!0});return t}var d="SUN MON TUES WEN THU FRI SAT".split(" ");e.bindingHandlers.calendarGrid={init:function(r,l){var i=l(),o=new Date(i.year,i.month);r.innerHTML="";for(var s=document.createElement("tbody"),u=document.createElement("tr"),h=0;7>h;h++){var c=document.createElement("td");c.classList.add("top"),c.appendChild(document.createTextNode(d[h])),u.appendChild(c)}s.appendChild(u);var m=0,v=n(o);console.log(v);var g=v.length/7;for(h=0;g>h;h++){var p=document.createElement("tr"),f=7*m++,M=v.slice(f,f+7);M.forEach(function(n,d){var r=document.createElement("td");r.setAttribute("data-bind","click: showFull"),r.id=Math.random(),n.anotherMonth&&r.classList.add("another-month"),r.innerHTML='<div class="date-num">'+n.num+'</div><div class="events-number" data-bind="text: eventsNumber, visible: tasks().length > 3"></div><ul data-bind="foreach: tasks"><li class="item"><div data-bind="text: title"></div></li></ul>',p.appendChild(r),e.applyBindings(new t(a[n.date],n.date,d,m),r)}),s.appendChild(p)}r.appendChild(s)}}});